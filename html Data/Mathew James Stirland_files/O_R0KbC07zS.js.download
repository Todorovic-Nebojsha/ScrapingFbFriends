if (self.CavalryLogger) { CavalryLogger.start_js(["oalUJ"]); }

__d("OGCollectionAddCuration",["AsyncRequest","DataStore","DOM","tidyEvent"],(function(a,b,c,d,e,f){__p&&__p();var g="OGCollectionAddCuration";function a(a,c,d,e,f,h){this._container=a,this._control=c,this._itemID=d,this._surface=f,this._display=h.display,c&&b("tidyEvent")([c.subscribe("reload",this.reloadControl.bind(this))]),e&&b("DataStore").set(String(e),g,this),d&&b("DataStore").set(String(d),g,this)}Object.assign(a,{handleDeleteAction:function(a){a=b("DataStore").get(String(a),g);a&&a.reloadControl()},handleAddItemSuccess:function(a,c,d){a=b("DataStore").get(String(a),g);b("DataStore").set(String(c),g,a);a.insertMenuIntoDialog(d)},hideControl:function(a){a=b("DataStore").get(String(a),g);a.hideControl()},insertControl:function(a,c){a=b("DataStore").get(String(a),g);a.replaceControl(c)},reloadControl:function(a){a=b("DataStore").get(String(a),g);a&&a.reloadControl()}});Object.assign(a.prototype,{hideControl:function(){this._control.hide()},reloadControl:function(){var a=new(b("AsyncRequest"))("/ajax/collections/add_curation").setData({itemid:this._itemID,surface:this._surface,forceedit:!0,display:this._display}).setHandler(this._handleAddCurationResponse.bind(this));a.send()},insertMenuIntoDialog:function(a){this._control.insertMenuIntoDialog(a)},replaceControl:function(a){b("DOM").replace(this._container,a)},getMenuControl:function(){return this._control},_handleAddCurationResponse:function(a){this._control.destroy(),b("DOM").replace(this._container,a.payload)}});e.exports=a}),null);
__d("OGCollectionAddDialog",["csx","AsyncRequest","DataStore","DOMQuery","Form","MenuDeprecated","URI","collectDataAttributes","tidyEvent"],(function(a,b,c,d,e,f,g){__p&&__p();var h="OGCollectionAddDialog";function a(a,c,d,e,f){this._dialog=a,this._surface=c,this._endpoint=new(b("URI"))(e),this._loadEditMenu=f.loadEditMenu,this._listener=b("DataStore").get(String(d),h),this._audienceSelector=b("DOMQuery").find(this._dialog.getContent(),".audienceSelector"),this._menu=b("DOMQuery").find(this._dialog.getContent(),"._4-jt"),b("MenuDeprecated").register(this._menu),this._menuSubscriptionToken=b("MenuDeprecated").subscribe("select",this._onMenuClick.bind(this)),b("tidyEvent")([this._dialog.subscribe("show",this._onDialogShow.bind(this)),this._dialog.subscribe("hide",this._onDialogHide.bind(this))]),f.setContextToParent&&this._dialog.setContext(this._dialog.getContext().parentNode),this._dialog.show()}Object.assign(a,{INSTANCE_KEY:h});Object.assign(a.prototype,{_onDialogShow:function(){this._listener.onDialogShow(this._dialog)},_onDialogHide:function(){this._destroy()},_onMenuClick:function(a,c){if(c.menu!==this._menu)return;a=c.item;this._listener.onMenuClick(a);c=b("DOMQuery").find(a,"._5581");a=c.getAttribute("value");this._submitRequest(a)},_submitRequest:function(a){this._endpoint.addQueryData({collection_token:a}),this._dialog.hide(),this._request=new(b("AsyncRequest"))(this._endpoint).setData(Object.assign(b("Form").serialize(this._audienceSelector),{action:"add",load_edit_menu:this._loadEditMenu,surface:this._surface},b("collectDataAttributes")(this._dialog.getContext(),["ft"]))),this._request.send()},_destroy:function(){this._listener.onDialogHide(),b("MenuDeprecated").unsubscribe(this._menuSubscriptionToken)}});e.exports=a}),null);
__d("OGCollectionAddMenu",["csx","cx","CSS","DataStore","DOM","DOMQuery","Event","OGCollectionAddDialog","Parent","TidyArbiterMixin","tidyEvent"],(function(a,b,c,d,e,f,g,h){__p&&__p();function i(a,c,d,e,f,g){this._image=c,this._container=d,this._placeholder=e,this._surface=f,this._rateControl=b("DOM").scry(this._container.parentNode,"._5fza")[0],i.inform("addButton",{button:this._image,root:this._container}),b("tidyEvent")(b("Event").listen(this._container,"click",function(a){var c=b("Parent").bySelector(a.getTarget(),"._5859");this.isDialogShowing()&&c&&a.kill()}.bind(this))),this._surface==="friend_timeline_lhc"&&this._handleAlwaysVisibleLHC(),b("DataStore").set(String(a),b("OGCollectionAddDialog").INSTANCE_KEY,this)}Object.assign(i,b("TidyArbiterMixin"));Object.assign(i.prototype,b("TidyArbiterMixin"),{destroy:function(){b("DOM").remove(this._container),this._placeholder.destroy()},hide:function(){b("CSS").hide(this._image),this._placeholder.hide()},getParent:function(){return this._container.parentNode},insertMenuIntoDialog:function(a){this._placeholder.insertIntoDialog(a)},onMenuClick:function(a){a=b("DOMQuery").find(a,"._5582");this._showRate=this._rateControl&&a.getAttribute("value");this._showRate?(this.switchToShowRate(),b("Event").fire(this._rateControl,"click")):this._switchToShowPlaceholder();this.inform("menuclicked")},onDialogShow:function(a){a=b("DOMQuery").find(a.getContent(),".audienceSelector");b("CSS").addClass(this._image,"openToggler");i.inform("menuOpened",{audienceSelector:a.parentNode});this._dialogShowing=!0},onDialogHide:function(){b("CSS").removeClass(this._image,"openToggler"),this._dialogShowing=!1},isDialogShowing:function(){return this._dialogShowing},_switchToShowPlaceholder:function(){b("CSS").hide(this._image),b("CSS").show(this._placeholder.getIcon())},switchToShowRate:function(){b("CSS").hide(this._image),b("CSS").show(this._rateControl)},_handleAlwaysVisibleLHC:function(){var a=b("Parent").bySelector(this._container,"._4_ij"),c=b("Parent").bySelector(a,"._5-r");b("CSS").matchesSelector(a,"._58v0")&&b("tidyEvent")([this._alwaysVisibleToken=b("Event").listen(c,"mouseenter",function(){b("CSS").removeClass(a,"_58v0"),this._alwaysVisibleToken.remove()}.bind(this))])}});e.exports=i}),null);
__d("OGCollectionAddedIconPlaceholder",["csx","CSS","DataStore","DOM","DOMQuery","Event","tidyEvent"],(function(a,b,c,d,e,f,g){__p&&__p();var h="OGCollectionAddedIconPlaceholder";function a(a,c,d,e){this._dialog=d,this._icon=c,this._addPlaceholder=e,b("tidyEvent")(b("Event").listen(c,"click",d.show.bind(d))),b("DataStore").set(String(a),h,this)}Object.assign(a,{loadEditMenu:function(a,c){a=b("DataStore").get(String(a),h);a.insertIntoDialog(c)}});Object.assign(a.prototype,{destroy:function(){this._dialog.destroy()},getIcon:function(){return this._icon},hide:function(){b("CSS").hide(this._icon),b("CSS").show(this._addPlaceholder),this._dialog.hide()},insertIntoDialog:function(a){b("DOM").setContent(b("DOMQuery").find(this._dialog.getContent(),"._51rr"),a)}});e.exports=a}),null);
__d("OGCollectionAddedIconRate",["DataStore","Event","tidyEvent"],(function(a,b,c,d,e,f){__p&&__p();var g="OGCollectionAddedIconRate";function a(a,c){this._link=a,b("DataStore").set(String(c),g,this)}a.disable=function(a){a=b("DataStore").get(String(a),g);a._disable()};Object.assign(a.prototype,{_disable:function(){b("tidyEvent")(b("Event").listen(this._link,"click",function(a){a.kill()}))}});e.exports=a}),null);